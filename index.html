<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Alokasi Investasi</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px}
        .container{max-width:900px;margin:0 auto;background:rgba(255,255,255,.95);backdrop-filter:blur(10px);border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.1);overflow:hidden}
        .header{background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%);color:#fff;padding:30px;text-align:center}
        .header h1{font-size:2.5rem;margin-bottom:10px;font-weight:700}
        .header p{font-size:1.1rem;opacity:.9}
        .content{padding:40px}
        .section{margin-bottom:40px}
        .section h2{color:#2c3e50;margin-bottom:20px;font-size:1.5rem;border-bottom:3px solid #3498db;padding-bottom:10px}
        .form-group{margin-bottom:25px}
        .form-group label{display:block;margin-bottom:8px;font-weight:600;color:#2c3e50}
        .form-group input,.form-group select{width:100%;padding:12px;border:2px solid #ddd;border-radius:8px;font-size:16px;transition:border-color .3s ease}
        .form-group input:focus,.form-group select:focus{outline:none;border-color:#3498db}
        .question{background:#f8f9fa;padding:20px;border-radius:12px;margin-bottom:20px;border-left:4px solid #3498db}
        .question h3{color:#2c3e50;margin-bottom:15px}
        .options{display:grid;gap:10px}
        .option{padding:12px;background:#fff;border:2px solid #e9ecef;border-radius:8px;cursor:pointer;transition:all .3s ease;position:relative}
        .option:hover{border-color:#3498db;transform:translateY(-2px);box-shadow:0 4px 12px rgba(52,152,219,.15)}
        .option input[type=radio]{position:absolute;opacity:0}
        .option label{cursor:pointer;display:block;width:100%}
        .btn{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:15px 30px;border:none;border-radius:8px;font-size:18px;font-weight:600;cursor:pointer;transition:all .3s ease;width:100%;margin-top:20px}
        .btn:hover{transform:translateY(-2px);box-shadow:0 10px 20px rgba(0,0,0,.2)}
        .result{display:none;background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%);padding:30px;border-radius:15px;margin-top:30px}
        .risk-profile{text-align:center;margin-bottom:30px}
        .risk-badge{display:inline-block;padding:10px 20px;border-radius:25px;font-weight:700;font-size:1.2rem;margin-bottom:10px}
        .risk-conservative{background:#2ecc71;color:#fff}
        .risk-moderate{background:#f39c12;color:#fff}
        .risk-aggressive{background:#e74c3c;color:#fff}
        .allocation-chart{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin:30px 0}
        .asset-card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 5px 15px rgba(0,0,0,.1);text-align:center}
        .asset-icon{font-size:3rem;margin-bottom:10px}
        .asset-percentage{font-size:2rem;font-weight:700;color:#2c3e50;margin-bottom:5px}
        .asset-name{font-weight:600;color:#7f8c8d}
        .progress-bar{background:#ecf0f1;height:8px;border-radius:4px;margin:10px 0;overflow:hidden}
        .progress-fill{height:100%;background:linear-gradient(90deg,#667eea,#764ba2);transition:width 1s ease}
        .recommendation{background:#fff;padding:25px;border-radius:12px;margin-top:20px}
        .recommendation h3{color:#2c3e50;margin-bottom:15px}
        .recommendation ul{list-style:none;padding-left:0}
        .recommendation li{padding:8px 0;border-bottom:1px solid #ecf0f1;display:flex;align-items:center}
        .recommendation li:before{content:"‚úì";color:#27ae60;font-weight:bold;margin-right:10px}
        @media(max-width:768px){.container{margin:10px;border-radius:15px}.content{padding:20px}.header h1{font-size:2rem}.allocation-chart{grid-template-columns:1fr}}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Kalkulator Alokasi Investasi</h1>
            <p>Temukan strategi investasi yang tepat sesuai profil risiko Anda</p>
        </div>

        <div class="content">
            <!-- Informasi Dasar -->
            <div class="section">
                <h2>üìä Informasi Dasar</h2>
                <div class="form-group">
                    <label>Nama Lengkap</label>
                    <input id="fullName" placeholder="Contoh: Andi Wijaya">
                </div>
                <div class="form-group">
                    <label>Jumlah Investasi (Rp)</label>
                    <input id="investmentAmount" placeholder="Contoh: 10.000.000">
                </div>
                <div class="form-group">
                    <label>Pengeluaran Bulanan (Rp)</label>
                    <input id="monthlyExpense" placeholder="Digunakan untuk hitung dana darurat">
                </div>
                <div class="form-group">
                    <label>Jangka Waktu Investasi</label>
                    <select id="investmentPeriod">
                        <option value="">Pilih jangka waktu</option>
                        <option value="1">< 1 tahun</option>
                        <option value="2">1-3 tahun</option>
                        <option value="3">3-5 tahun</option>
                        <option value="4">5-10 tahun</option>
                        <option value="5">> 10 tahun</option>
                    </select>
                </div>
            </div>

            <!-- Profil Risiko -->
            <div class="section">
                <h2>üß† Profil Risiko</h2>
                <!-- 4 pertanyaan tetap sama -->
                <div class="question">
                    <h3>1. Bagaimana reaksi Anda jika nilai investasi turun 20% dalam sebulan?</h3>
                    <div class="options">
                        <div class="option"><input type="radio" name="q1" value="1" id="q1_1"><label for="q1_1">Sangat panik dan segera menjual semua investasi</label></div>
                        <div class="option"><input type="radio" name="q1" value="2" id="q1_2"><label for="q1_2">Khawatir tapi akan menunggu beberapa bulan</label></div>
                        <div class="option"><input type="radio" name="q1" value="3" id="q1_3"><label for="q1_3">Tetap tenang dan melihat sebagai peluang beli</label></div>
                    </div>
                </div>
                <div class="question">
                    <h3>2. Berapa persentase maksimal kerugian yang bisa Anda terima?</h3>
                    <div class="options">
                        <div class="option"><input type="radio" name="q2" value="1" id="q2_1"><label for="q2_1">Maksimal 5% - saya tidak suka rugi</label></div>
                        <div class="option"><input type="radio" name="q2" value="2" id="q2_2"><label for="q2_2">10-15% - wajar untuk investasi</label></div>
                        <div class="option"><input type="radio" name="q2" value="3" id="q2_3"><label for="q2_3">20%+ - tidak masalah untuk return tinggi</label></div>
                    </div>
                </div>
                <div class="question">
                    <h3>3. Pengalaman investasi Anda?</h3>
                    <div class="options">
                        <div class="option"><input type="radio" name="q3" value="1" id="q3_1"><label for="q3_1">Pemula - baru mulai investasi</label></div>
                        <div class="option"><input type="radio" name="q3" value="2" id="q3_2"><label for="q3_2">Menengah - sudah 2-5 tahun</label></div>
                        <div class="option"><input type="radio" name="q3" value="3" id="q3_3"><label for="q3_3">Berpengalaman - lebih dari 5 tahun</label></div>
                    </div>
                </div>
                <div class="question">
                    <h3>4. Tujuan utama investasi Anda?</h3>
                    <div class="options">
                        <div class="option"><input type="radio" name="q4" value="1" id="q4_1"><label for="q4_1">Menjaga nilai uang dari inflasi</label></div>
                        <div class="option"><input type="radio" name="q4" value="2" id="q4_2"><label for="q4_2">Pertumbuhan modal moderat</label></div>
                        <div class="option"><input type="radio" name="q4" value="3" id="q4_3"><label for="q4_3">Maksimalkan keuntungan jangka panjang</label></div>
                    </div>
                </div>

                <button class="btn" onclick="calculateAllocation()">üîç Analisis Profil Risiko & Buat Alokasi</button>
            </div>

            <!-- Hasil -->
            <div class="result" id="result">
                <div class="risk-profile" id="riskProfile"></div>
                <div class="allocation-chart" id="allocationChart"></div>
                <div class="recommendation" id="recommendation"></div>
                <button class="btn" onclick="downloadPDF()">üì• Unduh PDF</button>
            </div>
        </div>
    </div>

    <!-- jsPDF & html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        /* ---------- DATA PROFIL ---------- */
        const profiles = {
            conservative:{
                name:"Konservatif",badge:"risk-conservative",icon:"üõ°Ô∏è",desc:"Mengutamakan keamanan modal",
                allocation:{
                    cash:{name:"Uang Tunai/Kas",percentage:10,icon:"üíµ"},
                    emergency:{name:"Dana Darurat (3√ó bln)",percentage:15,icon:"üöë"},
                    bonds:{name:"Obligasi & Sukuk",percentage:45,icon:"üè¶"},
                    deposits:{name:"Deposito",percentage:20,icon:"üí∞"},
                    stocks:{name:"Saham Blue-Chip",percentage:10,icon:"üìà"}
                },
                expReturn:"6-8%",riskLevel:"Rendah",
                rec:[
                    "Sisihkan 10% sebagai uang kas harian",
                    "Pastikan 15% menutupi 3√ó pengeluaran bulanan",
                    "Fokus pada obligasi pemerintah & deposito",
                    "Pilih saham dengan dividen stabil"
                ]
            },
            moderate:{
                name:"Moderat",badge:"risk-moderate",icon:"‚öñÔ∏è",desc:"Keseimbangan keamanan & pertumbuhan",
                allocation:{
                    cash:{name:"Uang Tunai/Kas",percentage:5,icon:"üíµ"},
                    emergency:{name:"Dana Darurat (3√ó bln)",percentage:10,icon:"üöë"},
                    stocks:{name:"Saham Campuran",percentage:40,icon:"üìä"},
                    bonds:{name:"Obligasi",percentage:30,icon:"üè¶"},
                    gold:{name:"Emas",percentage:10,icon:"ü•á"},
                    mixFund:{name:"Reksadana Campuran",percentage:5,icon:"üì¶"}
                },
                expReturn:"8-12%",riskLevel:"Menengah",
                rec:[
                    "Pertahankan kas 5% & dana darurat 10%",
                    "Kombinasikan saham value & growth",
                    "Rebalancing portofolio tiap 6 bulan",
                    "Tambahkan emas sebagai lindung nilai"
                ]
            },
            aggressive:{
                name:"Agresif",badge:"risk-aggressive",icon:"üöÄ",desc:"Maksimalkan pertumbuhan jangka panjang",
                allocation:{
                    cash:{name:"Uang Tunai/Kas",percentage:3,icon:"üíµ"},
                    emergency:{name:"Dana Darurat (3√ó bln)",percentage:7,icon:"üöë"},
                    stocks:{name:"Saham Growth",percentage:55,icon:"üöÄ"},
                    mutual:{name:"Reksadana Saham",percentage:20,icon:"üìà"},
                    crypto:{name:"Cryptocurrency",percentage:10,icon:"‚Çø"},
                    bonds:{name:"Obligasi",percentage:5,icon:"üè¶"}
                },
                expReturn:"12-20%",riskLevel:"Tinggi",
                rec:[
                    "Tetap sediakan dana darurat minimal 7%",
                    "Fokus pada saham teknologi & emerging markets",
                    "Alokasi kecil aset digital (<10%)",
                    "Gunakan cost-averaging untuk kurangi volatilitas"
                ]
            }
        };

        /* ---------- HELPERS ---------- */
        const formatNumber = n=>n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");
        const parseNum = str=>parseInt(str.replace(/\D/g,''));
        const idr = v=>new Intl.NumberFormat('id-ID',{style:'currency',currency:'IDR',minimumFractionDigits:0}).format(v);

        /* ---------- CORE LOGIC ---------- */
        function calculateAllocation(){
            const name=document.getElementById('fullName').value.trim();
            const amtStr=document.getElementById('investmentAmount').value;
            const expStr=document.getElementById('monthlyExpense').value;
            const per=document.getElementById('investmentPeriod').value;

            if(!name||!amtStr||!expStr||!per){alert('Mohon lengkapi semua data dasar!');return;}
            const amount=parseNum(amtStr),expense=parseNum(expStr);
            if(amount<1e6){alert('Minimal investasi Rp 1.000.000');return;}

            let score=0;
            for(let i=1;i<=4;i++){
                const a=document.querySelector(`input[name="q${i}"]:checked`);
                if(!a){alert(`Jawab pertanyaan ${i}`);return;}
                score+=parseInt(a.value);
            }
            score+=parseInt(per)*.5;

            let prof;
            if(score<=6)prof=profiles.conservative;
            else if(score<=10)prof=profiles.moderate;
            else prof=profiles.aggressive;

            showResult(prof,amount,expense,name);
        }
        function showResult(prof,amount,expense,name){
            const cashAmt=(amount*prof.allocation.cash.percentage)/100;
            const emergAmt=(amount*prof.allocation.emergency.percentage)/100;
            const neededEmerg=expense*3;
            let htmlProfile=`
                <h2>Halo, ${name}!</h2>
                <div class="risk-badge ${prof.badge}">${prof.icon} ${prof.name}</div>
                <p>${prof.desc}</p>
                <p><strong>Expected Return:</strong> ${prof.expReturn} per tahun</p>
                <p><strong>Risk Level:</strong> ${prof.riskLevel}</p>
            `;
            let htmlAlloc='';
            for(const[k,a]of Object.entries(prof.allocation)){
                const pct=a.percentage,alloc=(amount*pct)/100;
                htmlAlloc+=`
                    <div class="asset-card">
                        <div class="asset-icon">${a.icon}</div>
                        <div class="asset-percentage">${pct}%</div>
                        <div class="asset-name">${a.name}</div>
                        <div class="progress-bar"><div class="progress-fill" style="width:${pct}%"></div></div>
                        <p><strong>${idr(alloc)}</strong></p>
                    </div>`;
            }
            let htmlRec=`<h3>üí° Rekomendasi</h3><ul>${prof.rec.map(r=>`<li>${r}</li>`).join('')}</ul>`;
            if(emergAmt<neededEmerg)htmlRec+=`<p style="color:#e74c3c"><br>‚ö†Ô∏è Alokasi dana darurat Anda (${idr(emergAmt)}) di bawah 3√ó pengeluaran bulanan (${idr(neededEmerg)}).<br>Pertimbangkan tambah alokasi atau kurangi pengeluaran.</p>`;

            document.getElementById('riskProfile').innerHTML=htmlProfile;
            document.getElementById('allocationChart').innerHTML=htmlAlloc;
            document.getElementById('recommendation').innerHTML=htmlRec;
            document.getElementById('result').style.display='block';
            document.getElementById('result').scrollIntoView({behavior:'smooth'});
        }

        /* ---------- PDF ---------- */
        async function downloadPDF(){
            const {jsPDF}=window.jspdf;
            const pdf=new jsPDF('p','mm','a4');
            const result=document.getElementById('result');
            const canvas=await html2canvas(result,{scale:2,useCORS:true});
            const imgData=canvas.toDataURL('image/png');
            const imgWidth=190;
            const pageHeight=295;
            const imgHeight=(canvas.height*imgWidth)/canvas.width;
            let heightLeft=imgHeight;
            let position=10;

            pdf.addImage(imgData,'PNG',10,position,imgWidth,imgHeight);
            heightLeft-=pageHeight;

            while(heightLeft>=0){
                position=heightLeft-imgHeight+10;
                pdf.addPage();
                pdf.addImage(imgData,'PNG',10,position,imgWidth,imgHeight);
                heightLeft-=pageHeight;
            }
            const name=document.getElementById('fullName').value.trim()||'Investor';
            pdf.save(`Alokasi-Investasi-${name}.pdf`);
        }

        /* ---------- UI ---------- */
        document.addEventListener('DOMContentLoaded',()=>{
            /* option card click */
            document.querySelectorAll('.option').forEach(opt=>{
                opt.addEventListener('click',function(){
                    const r=this.querySelector('input[type=radio]');
                    if(r){
                        r.checked=true;
                        this.parentNode.querySelectorAll('.option').forEach(s=>{
                            s.style.borderColor='#e9ecef';s.style.background='#fff';
                        });
                        this.style.borderColor='#3498db';this.style.background='#e3f2fd';
                    }
                });
            });
            /* numeric formatting */
            ['investmentAmount','monthlyExpense'].forEach(id=>{
                const el=document.getElementById(id);
                el.addEventListener('input',e=>{
                    let v=e.target.value.replace(/\D/g,'');
                    if(v)e.target.value=formatNumber(v);
                });
            });
        });
    </script>
</body>
</html>